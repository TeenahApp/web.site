<!DOCTYPE html>
<html lang="ar">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    
    <link rel="shortcut icon" href="../../img/favicon.ico" type="image/x-icon" />

    <title>تطبيق تينه - الواجهة البرمجيّة للتطبيق (API)</title>

    <!-- Bootstrap core CSS -->
    <link href="../../css/bootstrap.css" rel="stylesheet">

    <!-- Custom Google Web Font -->
    <link href="../../font-awesome/css/font-awesome.min.css" rel="stylesheet">

    <!-- Add custom CSS here -->
    <link href="../../css/landing-page.css" rel="stylesheet">

</head>

<body>

    <nav class="navbar navbar-inverse" role="navigation">
        <div class="container">
            <div class="navbar-header">
           	   <a class="navbar-brand" href="../../index.html">تطبيق تينه <span class="badge">تجريبي</span></a>
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-right navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="../../about.html">نبذة تعريفيّة</a></li>
                    <li><a href="#">الواجهة البرمجيّة للتطبيق (API)</a></li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>

        <!-- /.container -->
    </nav>

    <!-- Begin page content -->
      <div class="container">
        <div class="page-header">
          <h3>الواجهة البرمجيّة للتطبيق (API)</h3>
        </div>
        
        <div class="row">
        	
        	<div class="col-lg-9">
        	
        		<h4 class="text-muted">المستخدمون: مفاهيم أساسيّة</h4>

        		<p class="lead">
                    بعد أن تعرّف تينه على التطبيق الذي يستخدم تينه، تبقّى أن يتعرّف تينه على المستخدم الذي يستخدم التطبيق، حتّى يعرف تينه ما هي الموارد التي يُمكن للمستخدم الحاليّ أن يستخدمها، مثلاً، ما هي الدوائر التي يستطيع أن يصل إليها، الأفراد الذين يُمكنه استعراض ملفّاتهم الشخصيّة، و هكذا، و لكي يتم ذلك، لابدّ من فهم آلية تسجيل دخول المستخدم. الآلية كالتالي، يمدّ المستخدم يده لمصافحة الخادم للمرّة الأولى و معه رقم الجوّال كمُدخل، طالباً من الخادم إرسال رسالة نصيّة (SMS) تحوي كلمة مرور مؤقتة، كلمة المرور هذه؛ ستمهّد الطريق للمصافحة الثانيّة التي تتم بين المستخدم و الخادم و التي يحمل فيها المستخدم رقم جوّاله و كذلك كلمة المرور المؤقتة.
        		</p>

                <table class="table table-bordered api_table">
    <tr>
        <th colspan="2">المصافحة الأولى: الطلب</th>
    </tr>
    <tr>
        <td><span class="label label-success">GET</span></td>
        <td><pre class="api_url">{{teenah_api_url}}/users/token/{mobile}</pre></td>
    </tr>
     <tr>
        <td class="rtl" colspan="2">
            <ul>
                <li>
                    <code>{mobile}</code> رقم الجوّال مبدوءاً بالرقم الدولي وبدون الصفر في بداية الرقم، مثلاً 96655.
                </li>
            </ul>
        </td>
    </tr>
</table>

            <p class="lead">
                سيقوم الخادم (تينه) بإرسال رسالة نصيّة (SMS) إلى الجوّال مُدخل و ستكون ردود الخادم إمّا <code>204</code> في حال إرسال الرسالة أو <code>403</code> في حال أن رقم الجوّال غير صحيح:
            </p>

            <table class="table table-bordered api_table">
                <tr>
                    <th colspan="2">المصافحة الأولى: الردود</th>
                </tr>
                <!-- 204 -->
                <tr>
                    <td><span class="label label-info">204</span></td>
                    <td></td>
                </tr>
                <!-- 403 -->
         <tr>
        <td><span class="label label-danger">403</span></td>
        <td>
<pre class="api_url">
{
    "message": "Not authorized to access this resource."
}</pre>
        </td>
    </tr>
    <tr>
        <td class="rtl" colspan="2">
            <ul>
                <li>
                    <code>{message}</code> رسالة الخطأ التي يتم استقبالها من الخادم.
                </li>
            </ul>
        </td>
    </tr>

            </table>

            <h4 class="text-muted">المصافحة الثانية و تسجيل الدخول</h4>

            <p class="lead">
                بعد عملية المصافحة الأولى التي تمّت بين الخادم و المستخدم، يستطيع أن يطلب المستخدم من الخادم تسجيل دخوله من خلال الإرسال <code>POST</code> إلى هذا الرابط:
            </p>

            <table class="table table-bordered api_table">
    <tr>
        <th colspan="2">الطلب</th>
    </tr>
    <tr>
        <td><span class="label label-warning">POST</span></td>
        <td><pre class="api_url">{{teenah_api_url}}/users/login</pre></td>
    </tr>
    <tr>
        <td class="rtl" colspan="2">
            <ul>
                <li>
                    <code>{mobile}</code> (مطلوب) رقم الجوّال مبدوءاً بالرقم الدولي وبدون الصفر في بداية الرقم، مثلاً 96655.
                </li>
                <li>
                    <code>{sms_token}</code> (مطلوب) كلمة المرور المؤقتة المُرسلة إلى الجوّال.
                </li>
            </ul>
        </td>
    </tr>
</table>

            <p class="lead">
                بعد إرسال المُدخلات إلى الرابط السابق، سيردّ الخادم -بعد تسجيل الدخول- على  المستخدم برموز يتذكر المستخدم من خلالها، هذه الرموز التي ينبغي للمستخدم استخدامها في كل استدعاء لأي وظيفة من وظائف النظام. الردرو ستكون إما <code>200</code> أو <code>400</code> أو <code>403</code> أو <code>404</code>.
            </p>

            <table class="table table-bordered api_table">
    <tr>
        <th colspan="2">الردود</th>
    </tr>
    <tr>
        <td><span class="label label-success">200</span></td>
        <td>
<pre class="api_url">
{
    "user_token": "$2y$10$d8zl4DaH1.nYJncylUaVf.70UfQm/M55WiFPmoUefKkFhu2n4.uaC",
    "has_member": false
}
</pre>
        </td>
    </tr>
    <tr>
        <td class="rtl" colspan="2">
            <ul>
                <li>
                    <code>{user_token}</code> هذه الرموز هي التي تحدّد المستخدم الذي سجّل الدخول إلى تطبيق تينه.
                </li>
                <li>
                    <code>{sms_token}</code> كلمة المرور المؤقتة المُرسلة إلى الجوّال.
                </li>
            </ul>
        </td>
    </tr>
    <tr>
        <td><span class="label label-danger">400</span></td>
        <td>
<pre class="api_url">
{
    "message": "Wrong mobile number and/or SMS token."
}
</pre>
        </td>
    </tr>
    <tr>
        <td class="rtl" colspan="2">
            <ul>
                <li>
                    <code>{message}</code> رسالة الخطأ التي يتم استقبالها من الخادم.
                </li>
            </ul>
        </td>
    </tr>
    <tr>
        <td><span class="label label-danger">403</span></td>
        <td>
<pre class="api_url">
{
    "message": "Not authorized to access this resource."
}
</pre>
        </td>
    </tr>
    <tr>
        <td class="rtl" colspan="2">
            <ul>
                <li>
                    <code>{message}</code> رسالة الخطأ التي يتم استقبالها من الخادم.
                </li>
            </ul>
        </td>
    </tr>
    <tr>
        <td><span class="label label-danger">404</span></td>
        <td>
<pre class="api_url">
{
    "message": "User cannot be found."
}
</pre>
        </td>
    </tr>
    <tr>
        <td class="rtl" colspan="2">
            <ul>
                <li>
                    <code>{message}</code> رسالة الخطأ التي يتم استقبالها من الخادم.
                </li>
            </ul>
        </td>
    </tr>
</table>

        	</div>
        	
        	<div class="col-lg-3">
        		<div class="list-group">
        			<a href="getting-started.html" class="list-group-item">الشروع في الاستخدام</a>
        			<a href="#" class="list-group-item active">المستخدمون</a>
        			<a href="members.html" class="list-group-item">الأفراد</a>
        			<a href="circles.html" class="list-group-item">الدوائر</a>
        			<a href="events.html" class="list-group-item">المناسبات</a>
        			<a href="medias.html" class="list-group-item">الوسائط المتعدّدة</a>
        			<a href="messages.html" class="list-group-item">الرسائل</a>
        			<a href="social_medias.html" class="list-group-item">الشبكات الاجتماعيّة</a>
        			<a href="trustees.html" class="list-group-item">الوكلاء</a>
        			<a href="auto_completes.html" class="list-group-item">الإكمال التلقائي</a>
        		</div>
        	</div>
        	
        </div>
        
    </div>

    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <ul class="list-inline">
                        <li><a href="../../index.html">الأولى</a>
                        </li>
                        <li class="footer-menu-divider">&sdot;</li>
                        <li><a href="../../about.html">نبذة تعريفيّة</a>
                        </li>
                        <li class="footer-menu-divider">&sdot;</li>
                        <li><a href="#">الواجهة البرمجيّة للتطبيق (API)</a>
                        </li>
                    </ul>
                    <p class="copyright text-muted small">
                    تينه - هذا المشروع مُرخّص تحت
                   <a href="http://opensource.org/licenses/MIT">رخصة MIT</a>.
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="../../js/jquery-1.10.2.js"></script>
    <script src="../../js/bootstrap.js"></script>
    <script src="../../js/teenahapp.js"></script>
    
    <script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-46290132-1', 'teenahapp.github.io');
	ga('send', 'pageview');
    </script>

</body>

</html>
